<!doctype html>
<html>
  <head>
    <title>Test GazeJs Socket.io</title>

  </head>
  <body>

    <ul id="right"></ul>
    <ul id="left"></ul>


    <div id="cursor">x</div>
    
    <!-- <div id="words"> -->

    <!--   <span id="0">lorem</span> -->
    <!--   <span id="1">lorem</span> -->
    <!--   <span id="2">lorem</span> -->
    <!--   <span id="3">lorem</span> -->
    <!--   <span id="4">lorem</span> -->
    <!--   <span id="5">lorem</span> -->
    <!--   <span id="6">lorem</span> -->
    <!--   <span id="7">lorem</span> -->
    <!--   <span id="8">lorem</span> -->
    <!--   <span id="9">lorem</span> -->

      
    <!-- </div> -->
    
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      var socket = io();
      var lastTenLeftX = [];
      var lastTenLeftY = [];
      var cursorUpdateRate = 100;
      var offsetX= 130;
      var offsetY= 30;

      
      function update() {

      socket.emit('updateRequest', $('#m').val());
      $('#m').val('');
      return false;
      
      }
      setInterval(update, 1);
      setInterval(updateCursor, cursorUpdateRate);

      
      
      function updateCursor(){
      var d = document.getElementById('cursor');
      d.style.position = "absolute";


      var averageX = 0;
      var averageY = 0;
      for(i=0 ; i < lastTenLeftX.length ; i++){
		    averageX += lastTenLeftX[i];
		    }

		    
      for(i=0 ; i < lastTenLeftY.length ; i++){
		    averageY += lastTenLeftY[i];
		    }


		    averageX = averageX/lastTenLeftX.length;
		    averageY = averageY/lastTenLeftY.length;
      
      d.style.left = (averageX*screen.width-offsetX)+'px';
      d.style.top = (averageY*screen.height-offsetY)+'px';      
      
      <!-- $('#right').empty().append($('<li>').text("Right Eye : x : "+averageX+"   y :  "+averageY)); -->
      $('#left').empty().append($('<li>').text("Left Eye : x : "+averageX+"   y :  "+averageY));
	
      }
      
      socket.on('coordinates', function(leftX, leftY, rightX, rightY){

      
      lastTenLeftX.unshift(leftX);
      lastTenLeftY.unshift(leftY);
      
	if(lastTenLeftX.length>cursorUpdateRate){

		    tmp = [];
		    for(i=0 ; i < cursorUpdateRate ; i++){
				  
				  tmp.push(lastTenLeftX[i]);
				  }
				  lastTenLeftX = tmp;
      }
	if(lastTenLeftY.length>cursorUpdateRate){

		    tmp = [];
		    for(i=0 ; i < cursorUpdateRate ; i++){
				  
				  tmp.push(lastTenLeftY[i]);
				  }
				  lastTenLeftY = tmp;
      }



				      

	});
    </script>
    
  </body>
</html>
